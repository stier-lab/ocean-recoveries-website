---
import Layout from '@layouts/Layout.astro';
import WaveDivider from '@components/shared/WaveDivider.astro';
import StudySitesMap from '@components/research/StudySitesMap';
import { posts } from '@data/posts';

// Get 3 most recent news posts
const recentPosts = [...posts]
  .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime())
  .slice(0, 3);

// Format date helper
const formatDate = (dateStr: string) => {
  return new Date(dateStr).toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'short',
    day: 'numeric',
  });
};
---

<Layout
  title="Ocean Recoveries Lab | Engineering Resilience from Organisms to Ecosystems"
  description="Research lab at UC Santa Barbara studying coral reef and kelp forest resilience. We trace the mechanisms of resistance, recovery, and reorganization to make restoration predictable."
  keywords={['Ocean Recoveries Lab', 'coral reef research', 'kelp forest ecology', 'marine conservation', 'UC Santa Barbara', 'Adrian Stier', 'ecosystem resilience']}
>
  <!-- Hero Section - Cinematic Full Viewport -->
  <section class="hero">
    <div class="hero-media">
      <div class="hero-image" style="background-image: url('/images/coral-reef-panorama-anthias-fish.jpeg');"></div>
      <div class="hero-overlay"></div>
      <div class="hero-vignette"></div>
    </div>

    <!-- Floating particles for depth -->
    <div class="hero-particles" aria-hidden="true">
      <div class="particle particle-1"></div>
      <div class="particle particle-2"></div>
      <div class="particle particle-3"></div>
      <div class="particle particle-4"></div>
      <div class="particle particle-5"></div>
    </div>

    <div class="hero-content">
      <div class="container">
        <div class="hero-text">
          <!-- Institution badge -->
          <div class="hero-badge scroll-reveal">
            <span class="badge-dot"></span>
            <span>UC Santa Barbara</span>
          </div>

          <!-- Main title - Split lines for cinematic effect -->
          <h1 class="hero-title scroll-reveal stagger-1">
            <span class="title-line">Ocean</span>
            <span class="title-line title-accent">Recoveries</span>
            <span class="title-line">Lab</span>
          </h1>

          <!-- Tagline -->
          <p class="hero-tagline scroll-reveal stagger-2">
            Understanding collapse.<br class="hidden sm:inline" />
            <span class="tagline-accent">Designing recovery.</span>
          </p>

          <!-- Brief description -->
          <p class="hero-desc scroll-reveal stagger-3">
            We study coral reefs and kelp forests to identify the mechanisms that control resistance, recovery, and reorganization.
          </p>

          <!-- CTAs -->
          <div class="hero-actions scroll-reveal stagger-4">
            <a href="/research" class="btn-hero-primary">
              <span>Explore Research</span>
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
              </svg>
            </a>
            <a href="/join" class="btn-hero-secondary">
              <span>Join the Lab</span>
            </a>
          </div>

          <!-- Quick stats -->
          <div class="hero-stats scroll-reveal stagger-5">
            <div class="hero-stat">
              <span class="stat-value">75+</span>
              <span class="stat-label">Publications</span>
            </div>
            <div class="stat-divider"></div>
            <div class="hero-stat">
              <span class="stat-value">2</span>
              <span class="stat-label">LTER Sites</span>
            </div>
            <div class="stat-divider"></div>
            <div class="hero-stat">
              <span class="stat-value">15</span>
              <span class="stat-label">Years Research</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Scroll indicator -->
    <a href="#study-systems" class="scroll-indicator">
      <span class="scroll-text">Dive In</span>
      <div class="scroll-line">
        <div class="scroll-dot"></div>
      </div>
    </a>

    <WaveDivider id="hero-wave" fillColor="surface" />
  </section>

  <!-- Study Systems Section -->
  <section id="study-systems" class="study-systems">
    <div class="container">
      <!-- Section header -->
      <div class="section-header scroll-reveal">
        <span class="section-eyebrow">Our Research Focus</span>
        <h2 class="section-title">Two Systems,<br /><span class="title-gradient">Two Failure Modes</span></h2>
        <p class="section-desc">
          Kelp forests and coral reefs fail in fundamentally different ways. Comparing how they break reveals which mechanisms generalize—and which interventions transfer.
        </p>
      </div>

      <!-- Interactive Map -->
      <div class="map-container scroll-reveal">
        <StudySitesMap client:load />
      </div>

      <!-- Study System Cards -->
      <div class="systems-grid">
        <!-- Coral Reefs -->
        <a href="/research/coral-reefs" class="system-card system-card-coral scroll-reveal stagger-1">
          <div class="card-media">
            <img src="/images/cauliflower-coral-damselfish-reef.jpeg" alt="Coral reef ecosystem in Mo'orea" loading="lazy" />
            <div class="card-gradient"></div>
          </div>
          <div class="card-content">
            <div class="card-location">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
              </svg>
              <span>Mo'orea, French Polynesia</span>
            </div>
            <h3 class="card-title">Coral Reefs</h3>
            <p class="card-desc">Slow, chronic failure. Coral fate depends on wound healing and regeneration at the colony level. We study how individual capacities aggregate into population recovery.</p>
            <div class="card-cta">
              <span>Explore research</span>
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
              </svg>
            </div>
          </div>
          <div class="card-accent card-accent-coral"></div>
        </a>

        <!-- Kelp Forests -->
        <a href="/research/kelp-forests" class="system-card system-card-kelp scroll-reveal stagger-2">
          <div class="card-media">
            <img src="/images/giant-kelp-sunlight-underwater.jpeg" alt="Kelp forest ecosystem in Santa Barbara" loading="lazy" />
            <div class="card-gradient"></div>
          </div>
          <div class="card-content">
            <div class="card-location">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
              </svg>
              <span>Santa Barbara, California</span>
            </div>
            <h3 class="card-title">Kelp Forests</h3>
            <p class="card-desc">Fast, nonlinear transitions. Consumer–predator feedbacks can flip forests to barrens in months. We study what governs the tipping point—and what breaks the lock.</p>
            <div class="card-cta">
              <span>Explore research</span>
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
              </svg>
            </div>
          </div>
          <div class="card-accent card-accent-kelp"></div>
        </a>
      </div>
    </div>

    <WaveDivider id="study-wave" fillColor="navy-deep" />
  </section>

  <!-- Resilience Framework Section -->
  <section class="resilience-section">
    <div class="resilience-bg">
      <div class="resilience-orb resilience-orb-1"></div>
      <div class="resilience-orb resilience-orb-2"></div>
      <div class="resilience-mesh"></div>
    </div>

    <div class="container relative z-10">
      <div class="section-header scroll-reveal">
        <span class="section-eyebrow section-eyebrow-light">Our Framework</span>
        <h2 class="section-title section-title-light">Resilience<br /><span class="title-gradient">Across Scales</span></h2>
        <p class="section-desc text-white/60">
          Resilience isn't something ecosystems "have." It emerges from processes at multiple levels—individual, population, and ecosystem—and these levels connect.
        </p>
      </div>

      <!-- Three Pillars -->
      <div class="pillars-grid">
        <!-- Resistance -->
        <div class="pillar-card scroll-reveal stagger-1">
          <div class="pillar-header">
            <div class="pillar-icon pillar-icon-resistance">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
              </svg>
            </div>
            <h3 class="pillar-title">Resistance</h3>
          </div>
          <p class="pillar-tagline">What prevents collapse when disturbance hits</p>
          <ul class="pillar-list">
            <li><span class="pillar-level pillar-level-1">Individual:</span> stress tolerance, damage thresholds</li>
            <li><span class="pillar-level pillar-level-1">Population:</span> demographic buffering, spatial refugia</li>
            <li><span class="pillar-level pillar-level-1">Ecosystem:</span> stabilizing feedbacks, trophic structure</li>
          </ul>
        </div>

        <!-- Recovery -->
        <div class="pillar-card pillar-card-featured scroll-reveal stagger-2">
          <div class="pillar-header">
            <div class="pillar-icon pillar-icon-recovery">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
              </svg>
            </div>
            <h3 class="pillar-title">Recovery</h3>
          </div>
          <p class="pillar-tagline">What controls the speed and reliability of return</p>
          <ul class="pillar-list">
            <li><span class="pillar-level pillar-level-2">Individual:</span> wound healing, regeneration capacity</li>
            <li><span class="pillar-level pillar-level-2">Population:</span> recruitment, connectivity</li>
            <li><span class="pillar-level pillar-level-2">Ecosystem:</span> facilitation cascades, succession</li>
          </ul>
        </div>

        <!-- Reorganization -->
        <div class="pillar-card scroll-reveal stagger-3">
          <div class="pillar-header">
            <div class="pillar-icon pillar-icon-reorg">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" />
              </svg>
            </div>
            <h3 class="pillar-title">Reorganization</h3>
          </div>
          <p class="pillar-tagline">What determines the next state when return isn't possible</p>
          <ul class="pillar-list">
            <li><span class="pillar-level pillar-level-3">Individual:</span> how tolerances filter survivors</li>
            <li><span class="pillar-level pillar-level-3">Population:</span> how populations reassemble</li>
            <li><span class="pillar-level pillar-level-3">Ecosystem:</span> how interactions rewire</li>
          </ul>
        </div>
      </div>

      <div class="section-cta scroll-reveal">
        <a href="/research" class="btn-outline-light">
          <span>Learn how we do science</span>
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
          </svg>
        </a>
      </div>
    </div>

    <WaveDivider id="pillars-wave" fillColor="surface" />
  </section>

  <!-- Focal Organisms Section -->
  <section class="organisms-section">
    <div class="container">
      <div class="section-header scroll-reveal">
        <span class="section-eyebrow">What We Study</span>
        <h2 class="section-title">Focal Organisms<br /><span class="title-gradient">& Scales</span></h2>
        <p class="section-desc">
          From cellular mechanisms of coral healing to ecosystem consequences of predator loss.
        </p>
      </div>

      <div class="organisms-grid">
        <!-- Corals -->
        <div class="organism-card scroll-reveal stagger-1">
          <div class="organism-visual">
            <img src="/images/chromis-acropora.jpeg" alt="Coral colony" loading="lazy" />
            <div class="organism-overlay"></div>
          </div>
          <div class="organism-content">
            <h3 class="organism-name">Corals</h3>
            <p class="organism-desc">How colonies heal damage, regenerate tissue, and allocate energy under thermal stress.</p>
          </div>
        </div>

        <!-- Lobsters & Urchins -->
        <div class="organism-card scroll-reveal stagger-2">
          <div class="organism-visual">
            <img src="/images/lobster.jpeg" alt="Spiny lobster" loading="lazy" />
            <div class="organism-overlay"></div>
          </div>
          <div class="organism-content">
            <h3 class="organism-name">Lobsters & Urchins</h3>
            <p class="organism-desc">How consumers structure kelp dynamics through predation, grazing, and behavior.</p>
          </div>
        </div>

        <!-- Kelp -->
        <div class="organism-card scroll-reveal stagger-3">
          <div class="organism-visual">
            <img src="/images/kelp-hero.jpeg" alt="Giant kelp" loading="lazy" />
            <div class="organism-overlay"></div>
          </div>
          <div class="organism-content">
            <h3 class="organism-name">Kelp</h3>
            <p class="organism-desc">How resistance to grazing and storms interacts with recruitment for forest persistence.</p>
          </div>
        </div>

        <!-- Reef Fish -->
        <div class="organism-card scroll-reveal stagger-4">
          <div class="organism-visual">
            <img src="/images/damselfish-pair-acropora-coral.jpeg" alt="Reef fish" loading="lazy" />
            <div class="organism-overlay"></div>
          </div>
          <div class="organism-content">
            <h3 class="organism-name">Reef Fish</h3>
            <p class="organism-desc">How fish–coral mutualisms enhance survival and how fishing alters stabilizing networks.</p>
          </div>
        </div>
      </div>
    </div>

    <WaveDivider id="organisms-wave" fillColor="navy-deep" />
  </section>

  <!-- Recent News Section -->
  <section class="news-section">
    <div class="news-bg">
      <div class="news-gradient"></div>
    </div>

    <div class="container relative z-10">
      <div class="news-header scroll-reveal">
        <div class="news-header-text">
          <span class="section-eyebrow section-eyebrow-light">Latest Updates</span>
          <h2 class="section-title section-title-light">Recent Research</h2>
        </div>
        <a href="/news" class="btn-outline-light hidden sm:inline-flex">
          <span>View all news</span>
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
          </svg>
        </a>
      </div>

      <div class="news-grid">
        {recentPosts.map((post, i) => (
          <article class={`news-card scroll-reveal stagger-${i + 1}`}>
            <a href={`/news/${post.slug}`} class="news-link">
              <div class="news-image">
                <img src={post.featuredImage} alt={post.title} loading={i === 0 ? 'eager' : 'lazy'} />
                <div class="news-date-badge">{formatDate(post.date)}</div>
              </div>
              <div class="news-body">
                <div class="news-tags">
                  {post.tags.slice(0, 2).map(tag => (
                    <span class="news-tag">{tag}</span>
                  ))}
                </div>
                <h3 class="news-title">{post.title}</h3>
                <p class="news-excerpt">{post.excerpt}</p>
                <div class="news-read-more">
                  <span>Read article</span>
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
                  </svg>
                </div>
              </div>
            </a>
          </article>
        ))}
      </div>

      <div class="news-mobile-cta scroll-reveal sm:hidden">
        <a href="/news" class="btn-outline-light">View All News</a>
      </div>
    </div>

    <WaveDivider id="news-wave" fillColor="surface" />
  </section>

  <!-- About Section -->
  <section class="about-section">
    <div class="container">
      <div class="about-grid">
        <div class="about-content scroll-reveal">
          <span class="section-eyebrow">Our Lab</span>
          <h2 class="section-title">Based at<br /><span class="title-gradient">UC Santa Barbara</span></h2>
          <p class="about-text">
            The Ocean Recoveries Lab is part of the Department of Ecology, Evolution & Marine Biology. We benefit from world-class marine facilities, the Santa Barbara Coastal LTER, and partnerships with the Moorea Coral Reef LTER.
          </p>

          <!-- PI Card -->
          <a href="/people" class="pi-card">
            <img src="/images/adrian.png" alt="Adrian Stier" class="pi-photo" />
            <div class="pi-info">
              <span class="pi-name">Adrian Stier</span>
              <span class="pi-title">Associate Professor, EEMB</span>
              <span class="pi-detail">Long-term experiments at MCR and SBC LTER. 75+ papers on reef and kelp dynamics.</span>
            </div>
            <svg class="pi-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
            </svg>
          </a>

          <a href="/people" class="btn-primary">
            <span>Meet the Team</span>
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
            </svg>
          </a>
        </div>

        <div class="about-stats">
          <div class="stat-card scroll-reveal stagger-1">
            <span class="stat-number" data-target="75">75</span>
            <span class="stat-plus">+</span>
            <span class="stat-label">Publications</span>
          </div>
          <div class="stat-card scroll-reveal stagger-2">
            <span class="stat-number" data-target="15">15</span>
            <span class="stat-plus">yrs</span>
            <span class="stat-label">Research Experience</span>
          </div>
          <div class="stat-card scroll-reveal stagger-3">
            <span class="stat-number" data-target="2">2</span>
            <span class="stat-label">LTER Sites</span>
          </div>
          <div class="stat-card scroll-reveal stagger-4">
            <span class="stat-number" data-target="12">12</span>
            <span class="stat-plus">+</span>
            <span class="stat-label">Partner Institutions</span>
          </div>
        </div>
      </div>
    </div>

    <WaveDivider id="about-wave" fillColor="navy-deep" />
  </section>

  <!-- Final CTA Section -->
  <section class="cta-section">
    <div class="cta-bg">
      <div class="cta-orb cta-orb-1"></div>
      <div class="cta-orb cta-orb-2"></div>
    </div>

    <div class="container relative z-10">
      <div class="cta-grid">
        <!-- Join CTA -->
        <div class="cta-card cta-card-join scroll-reveal">
          <div class="cta-card-content">
            <span class="cta-eyebrow">For Researchers</span>
            <h2 class="cta-title">Join Our Team</h2>
            <p class="cta-desc">
              We're seeking researchers at all career stages who want to understand and restore ocean ecosystems.
            </p>
            <a href="/join" class="btn-cta-primary">
              <span>View Opportunities</span>
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
              </svg>
            </a>
          </div>
        </div>

        <!-- Funders CTA -->
        <div class="cta-card cta-card-funder scroll-reveal stagger-1">
          <div class="cta-card-content">
            <span class="cta-eyebrow cta-eyebrow-alt">For Funders</span>
            <h2 class="cta-title">Partner With Us</h2>
            <p class="cta-desc">
              Support research that identifies why ecosystems fail and what makes restoration succeed.
            </p>
            <a href="/for-funders" class="btn-cta-secondary">
              <span>Learn More</span>
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
              </svg>
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>
</Layout>

<style>
  /* ============================================
     Hero Section - Cinematic Full Viewport
     ============================================ */
  .hero {
    @apply relative min-h-[100svh] flex items-center overflow-hidden;
  }

  .hero-media {
    @apply absolute inset-0;
  }

  .hero-image {
    @apply absolute inset-0 bg-cover bg-center bg-no-repeat;
    transform: scale(1.05);
    animation: heroZoom 20s ease-out forwards;
  }

  @keyframes heroZoom {
    from { transform: scale(1.05); }
    to { transform: scale(1); }
  }

  .hero-overlay {
    @apply absolute inset-0;
    background: linear-gradient(
      135deg,
      rgba(11, 25, 41, 0.92) 0%,
      rgba(11, 25, 41, 0.8) 40%,
      rgba(11, 37, 69, 0.6) 70%,
      rgba(11, 37, 69, 0.4) 100%
    );
  }

  .hero-vignette {
    @apply absolute inset-0;
    background: radial-gradient(ellipse at center, transparent 40%, rgba(11, 25, 41, 0.5) 100%);
  }

  /* Floating particles */
  .hero-particles {
    @apply absolute inset-0 overflow-hidden pointer-events-none;
  }

  .particle {
    @apply absolute rounded-full;
    background: rgba(56, 189, 248, 0.3);
    animation: float 15s ease-in-out infinite;
  }

  .particle-1 { width: 4px; height: 4px; top: 20%; left: 15%; animation-delay: 0s; }
  .particle-2 { width: 6px; height: 6px; top: 60%; left: 80%; animation-delay: -3s; }
  .particle-3 { width: 3px; height: 3px; top: 40%; left: 60%; animation-delay: -6s; }
  .particle-4 { width: 5px; height: 5px; top: 70%; left: 25%; animation-delay: -9s; }
  .particle-5 { width: 4px; height: 4px; top: 30%; left: 90%; animation-delay: -12s; }

  @keyframes float {
    0%, 100% { transform: translateY(0) translateX(0); opacity: 0.3; }
    25% { transform: translateY(-30px) translateX(10px); opacity: 0.6; }
    50% { transform: translateY(-10px) translateX(-10px); opacity: 0.4; }
    75% { transform: translateY(-40px) translateX(5px); opacity: 0.5; }
  }

  .hero-content {
    @apply relative z-10 w-full;
    padding-top: 8rem;
    padding-bottom: 10rem;
  }

  .hero-text {
    @apply max-w-2xl;
  }

  /* Badge */
  .hero-badge {
    @apply inline-flex items-center gap-2 mb-6;
    @apply text-xs font-bold uppercase tracking-[0.2em] text-white/70;
  }

  .badge-dot {
    @apply w-2 h-2 rounded-full bg-accent;
    animation: pulse 2s ease-in-out infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.5; transform: scale(1.2); }
  }

  /* Title */
  .hero-title {
    @apply text-5xl sm:text-6xl md:text-7xl lg:text-8xl font-black leading-[0.9] tracking-tight mb-6;
  }

  .title-line {
    @apply block text-white;
  }

  .title-accent {
    @apply bg-gradient-to-r from-accent via-accent-2 to-accent bg-clip-text text-transparent;
    background-size: 200% auto;
    animation: shimmer 8s ease-in-out infinite;
  }

  @keyframes shimmer {
    0%, 100% { background-position: 0% center; }
    50% { background-position: 100% center; }
  }

  /* Tagline */
  .hero-tagline {
    @apply text-xl md:text-2xl font-semibold text-white/80 mb-4 leading-snug;
  }

  .tagline-accent {
    @apply text-accent;
  }

  /* Description */
  .hero-desc {
    @apply text-base md:text-lg text-white/60 mb-8 leading-relaxed max-w-lg;
  }

  /* Actions */
  .hero-actions {
    @apply flex flex-wrap items-center gap-4 mb-10;
  }

  .btn-hero-primary {
    @apply inline-flex items-center gap-2 px-6 py-3;
    @apply bg-accent text-white font-bold text-sm;
    @apply rounded-full no-underline;
    @apply transition-all duration-300;
    @apply shadow-lg shadow-accent/25;
  }

  .btn-hero-primary:hover {
    @apply bg-accent/90 gap-3;
    transform: translateY(-2px);
    box-shadow: 0 20px 40px -12px rgba(56, 189, 248, 0.4);
  }

  .btn-hero-secondary {
    @apply inline-flex items-center gap-2 px-6 py-3;
    @apply text-white font-bold text-sm;
    @apply border-2 border-white/30 rounded-full no-underline;
    @apply transition-all duration-300;
  }

  .btn-hero-secondary:hover {
    @apply border-white/60 bg-white/10;
  }

  /* Stats */
  .hero-stats {
    @apply flex items-center gap-6 flex-wrap;
  }

  .hero-stat {
    @apply flex flex-col;
  }

  .stat-value {
    @apply text-2xl font-black text-white tabular-nums;
  }

  .stat-label {
    @apply text-xs font-medium uppercase tracking-wide text-white/40;
  }

  .stat-divider {
    @apply w-px h-10 bg-white/20;
  }

  /* Scroll indicator */
  .scroll-indicator {
    @apply absolute bottom-10 left-1/2 -translate-x-1/2;
    @apply flex flex-col items-center gap-3 no-underline;
    @apply text-white/60 transition-colors duration-300;
    animation: fadeIn 1s ease-out 1.5s forwards;
    opacity: 0;
  }

  .scroll-indicator:hover {
    @apply text-white;
  }

  @keyframes fadeIn {
    to { opacity: 1; }
  }

  .scroll-text {
    @apply text-xs font-bold uppercase tracking-[0.2em];
  }

  .scroll-line {
    @apply relative w-px h-12 bg-white/20 overflow-hidden;
  }

  .scroll-dot {
    @apply absolute top-0 left-0 w-full h-3 bg-accent;
    animation: scrollDown 2s ease-in-out infinite;
  }

  @keyframes scrollDown {
    0% { top: -12px; }
    50% { top: 48px; }
    100% { top: -12px; }
  }

  /* ============================================
     Section Styling
     ============================================ */
  .study-systems,
  .organisms-section,
  .about-section {
    @apply relative py-20 md:py-28 pb-28 md:pb-36 bg-surface;
  }

  .resilience-section,
  .news-section,
  .cta-section {
    @apply relative py-20 md:py-28 overflow-hidden;
    background: linear-gradient(180deg, #0b1929 0%, #0f172a 50%, #0b1929 100%);
  }

  .resilience-section {
    @apply pb-28 md:pb-36;
  }

  .section-header {
    @apply text-center mb-12;
  }

  .section-eyebrow {
    @apply inline-block text-xs font-bold uppercase tracking-[0.2em] text-accent mb-4;
  }

  .section-eyebrow-light {
    @apply text-accent-2;
  }

  .section-title {
    @apply text-3xl md:text-4xl lg:text-5xl font-black text-ink tracking-tight mb-4 leading-tight;
  }

  .section-title-light {
    color: white;
  }

  .title-gradient {
    @apply bg-gradient-to-r from-accent to-accent-2 bg-clip-text text-transparent;
  }

  .section-desc {
    @apply text-lg text-muted leading-relaxed max-w-2xl mx-auto;
  }

  .section-cta {
    @apply text-center mt-12;
  }

  /* ============================================
     Map Container
     ============================================ */
  .map-container {
    @apply max-w-5xl mx-auto mb-12;
  }

  /* ============================================
     Study System Cards
     ============================================ */
  .systems-grid {
    @apply grid md:grid-cols-2 gap-6 lg:gap-8 max-w-5xl mx-auto;
  }

  .system-card {
    @apply relative block rounded-2xl overflow-hidden no-underline;
    @apply border border-line/50;
    min-height: 420px;
    transition: all 500ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  .system-card:hover {
    transform: translateY(-8px);
    border-color: rgba(56, 189, 248, 0.4);
    box-shadow: 0 30px 60px -12px rgba(0, 0, 0, 0.3), 0 0 40px rgba(56, 189, 248, 0.1);
  }

  .card-media {
    @apply absolute inset-0;
  }

  .card-media img {
    @apply w-full h-full object-cover;
    transform: scale(1.05);
    transition: transform 700ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  .system-card:hover .card-media img {
    transform: scale(1.12);
  }

  .card-gradient {
    @apply absolute inset-0;
    background: linear-gradient(
      to top,
      rgba(15, 23, 42, 0.98) 0%,
      rgba(15, 23, 42, 0.85) 40%,
      rgba(15, 23, 42, 0.4) 70%,
      transparent 100%
    );
  }

  .card-content {
    @apply absolute bottom-0 left-0 right-0 p-6 md:p-8;
  }

  .card-location {
    @apply inline-flex items-center gap-1.5 text-accent-2 text-xs font-bold uppercase tracking-wider mb-3;
  }

  .card-title {
    @apply text-2xl md:text-3xl font-black text-white mb-3;
    transition: color 300ms ease;
  }

  .system-card:hover .card-title {
    @apply text-accent;
  }

  .card-desc {
    @apply text-white/70 text-sm leading-relaxed mb-4;
  }

  .card-cta {
    @apply inline-flex items-center gap-2 text-accent text-sm font-bold;
    transition: gap 300ms ease;
  }

  .system-card:hover .card-cta {
    @apply gap-3;
  }

  .card-accent {
    @apply absolute top-0 left-0 right-0 h-1;
  }

  .card-accent-coral {
    background: linear-gradient(90deg, #f97316, #fb923c, #fdba74);
  }

  .card-accent-kelp {
    background: linear-gradient(90deg, #22c55e, #4ade80, #86efac);
  }

  /* ============================================
     Resilience Section Background
     ============================================ */
  .resilience-bg {
    @apply absolute inset-0 overflow-hidden;
  }

  .resilience-orb {
    @apply absolute rounded-full;
    filter: blur(100px);
  }

  .resilience-orb-1 {
    @apply w-[600px] h-[600px] -top-48 -right-48;
    background: radial-gradient(circle, rgba(56, 189, 248, 0.12), transparent 70%);
    animation: orbFloat 20s ease-in-out infinite;
  }

  .resilience-orb-2 {
    @apply w-[500px] h-[500px] -bottom-32 -left-32;
    background: radial-gradient(circle, rgba(45, 212, 191, 0.1), transparent 70%);
    animation: orbFloat 25s ease-in-out infinite reverse;
  }

  @keyframes orbFloat {
    0%, 100% { transform: translate(0, 0) scale(1); }
    33% { transform: translate(30px, -20px) scale(1.05); }
    66% { transform: translate(-20px, 30px) scale(0.95); }
  }

  .resilience-mesh {
    @apply absolute inset-0 opacity-[0.03];
    background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%2338bdf8' fill-opacity='1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
  }

  /* ============================================
     Pillars Grid
     ============================================ */
  .pillars-grid {
    @apply grid md:grid-cols-3 gap-6 lg:gap-8 max-w-6xl mx-auto;
  }

  .pillar-card {
    @apply relative p-6 lg:p-8 rounded-2xl;
    @apply border border-white/10;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, rgba(255, 255, 255, 0.02) 100%);
    backdrop-filter: blur(10px);
    transition: all 400ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  .pillar-card:hover {
    transform: translateY(-6px);
    border-color: rgba(56, 189, 248, 0.3);
    box-shadow: 0 20px 40px -12px rgba(0, 0, 0, 0.3), 0 0 30px rgba(56, 189, 248, 0.1);
  }

  .pillar-card-featured {
    @apply border-accent/30;
    background: linear-gradient(135deg, rgba(56, 189, 248, 0.08) 0%, rgba(45, 212, 191, 0.04) 100%);
  }

  .pillar-header {
    @apply flex items-center gap-4 mb-4;
  }

  .pillar-icon {
    @apply w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0;
    transition: transform 300ms ease;
  }

  .pillar-card:hover .pillar-icon {
    transform: scale(1.1);
  }

  .pillar-icon-resistance {
    @apply bg-accent/20 text-accent;
  }

  .pillar-icon-recovery {
    @apply bg-accent-2/20 text-accent-2;
  }

  .pillar-icon-reorg {
    @apply bg-amber-500/20 text-amber-400;
  }

  .pillar-title {
    @apply text-xl font-bold text-white;
  }

  .pillar-tagline {
    @apply text-white/50 text-sm mb-5;
  }

  .pillar-list {
    @apply space-y-3;
  }

  .pillar-list li {
    @apply text-white/70 text-sm leading-relaxed;
  }

  .pillar-level {
    @apply font-semibold;
  }

  .pillar-level-1 { @apply text-accent; }
  .pillar-level-2 { @apply text-accent-2; }
  .pillar-level-3 { @apply text-amber-400; }

  /* ============================================
     Organisms Grid
     ============================================ */
  .organisms-grid {
    @apply grid sm:grid-cols-2 lg:grid-cols-4 gap-6 max-w-6xl mx-auto;
  }

  .organism-card {
    @apply relative rounded-2xl overflow-hidden;
    @apply border border-line/50 bg-surface-card;
    transition: all 400ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  .organism-card:hover {
    transform: translateY(-6px);
    border-color: rgba(56, 189, 248, 0.3);
    box-shadow: 0 20px 40px -12px rgba(0, 0, 0, 0.2);
  }

  .organism-visual {
    @apply relative aspect-[4/3] overflow-hidden;
  }

  .organism-visual img {
    @apply w-full h-full object-cover;
    transition: transform 600ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  .organism-card:hover .organism-visual img {
    transform: scale(1.08);
  }

  .organism-overlay {
    @apply absolute inset-0;
    background: linear-gradient(to top, rgba(15, 23, 42, 0.6) 0%, transparent 50%);
  }

  .organism-content {
    @apply p-5;
  }

  .organism-name {
    @apply text-lg font-bold text-ink mb-2;
  }

  .organism-desc {
    @apply text-muted text-sm leading-relaxed;
  }

  /* ============================================
     News Section
     ============================================ */
  .news-bg {
    @apply absolute inset-0;
  }

  .news-gradient {
    @apply absolute inset-0;
    background: linear-gradient(180deg, #0b1929 0%, rgba(15, 23, 42, 0.95) 50%, #0b1929 100%);
  }

  .news-header {
    @apply flex flex-col sm:flex-row sm:items-end sm:justify-between gap-4 mb-10;
  }

  .news-grid {
    @apply grid md:grid-cols-3 gap-6 lg:gap-8;
  }

  .news-card {
    @apply rounded-2xl overflow-hidden bg-surface-card;
    @apply border border-line/50;
    transition: all 400ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  .news-card:hover {
    transform: translateY(-6px);
    border-color: rgba(56, 189, 248, 0.3);
    box-shadow: 0 20px 40px -12px rgba(0, 0, 0, 0.3);
  }

  .news-link {
    @apply block no-underline h-full flex flex-col;
  }

  .news-image {
    @apply relative aspect-[16/10] overflow-hidden;
  }

  .news-image img {
    @apply w-full h-full object-cover;
    transition: transform 600ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  .news-card:hover .news-image img {
    transform: scale(1.05);
  }

  .news-date-badge {
    @apply absolute top-3 right-3 px-3 py-1.5 rounded-full;
    @apply bg-navy-deep/80 backdrop-blur-sm text-white/80 text-xs font-medium;
  }

  .news-body {
    @apply p-5 md:p-6 flex flex-col flex-1;
  }

  .news-tags {
    @apply flex flex-wrap gap-2 mb-3;
  }

  .news-tag {
    @apply text-xs font-bold uppercase tracking-wide text-accent;
  }

  .news-title {
    @apply text-lg font-bold text-ink mb-3 leading-snug;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    transition: color 200ms ease;
  }

  .news-card:hover .news-title {
    @apply text-accent;
  }

  .news-excerpt {
    @apply text-muted text-sm leading-relaxed mb-4 flex-1;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .news-read-more {
    @apply inline-flex items-center gap-2 text-accent text-sm font-bold mt-auto;
    transition: gap 300ms ease;
  }

  .news-card:hover .news-read-more {
    @apply gap-3;
  }

  .news-mobile-cta {
    @apply text-center mt-10;
  }

  /* ============================================
     About Section
     ============================================ */
  .about-grid {
    @apply grid lg:grid-cols-2 gap-12 lg:gap-20 items-center;
  }

  .about-content .section-title {
    @apply text-left;
  }

  .about-text {
    @apply text-muted text-lg leading-relaxed mb-6;
  }

  .pi-card {
    @apply flex items-center gap-4 p-4 rounded-xl mb-6;
    @apply bg-surface-card border border-line/50 no-underline;
    transition: all 300ms ease;
  }

  .pi-card:hover {
    @apply border-accent/30;
    box-shadow: 0 10px 30px -8px rgba(0, 0, 0, 0.15);
  }

  .pi-photo {
    @apply w-14 h-14 rounded-full object-cover flex-shrink-0;
    @apply ring-2 ring-accent/30;
  }

  .pi-info {
    @apply flex flex-col flex-1 min-w-0;
  }

  .pi-name {
    @apply text-sm font-bold text-ink;
  }

  .pi-title {
    @apply text-xs font-bold uppercase tracking-wide text-accent;
  }

  .pi-detail {
    @apply text-xs text-muted mt-1;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .pi-arrow {
    @apply w-4 h-4 text-accent/40 flex-shrink-0;
    transition: all 200ms ease;
  }

  .pi-card:hover .pi-arrow {
    @apply text-accent;
    transform: translateX(4px);
  }

  .about-stats {
    @apply grid grid-cols-2 gap-4 lg:gap-5;
  }

  .stat-card {
    @apply p-6 lg:p-7 rounded-2xl text-center;
    @apply bg-surface-card border border-line/50;
    transition: all 300ms ease;
  }

  .stat-card:hover {
    transform: translateY(-4px);
    border-color: rgba(56, 189, 248, 0.3);
    box-shadow: 0 15px 30px -8px rgba(0, 0, 0, 0.15);
  }

  .stat-number {
    @apply text-4xl lg:text-5xl font-black text-accent inline;
  }

  .stat-plus {
    @apply text-xl lg:text-2xl font-bold text-accent/70 ml-0.5;
  }

  .stat-label {
    @apply block text-xs font-semibold text-muted uppercase tracking-wider mt-2;
  }

  /* ============================================
     CTA Section
     ============================================ */
  .cta-bg {
    @apply absolute inset-0 overflow-hidden;
  }

  .cta-orb {
    @apply absolute rounded-full;
    filter: blur(100px);
  }

  .cta-orb-1 {
    @apply w-[400px] h-[400px] top-0 left-1/4;
    background: radial-gradient(circle, rgba(56, 189, 248, 0.15), transparent 70%);
  }

  .cta-orb-2 {
    @apply w-[350px] h-[350px] bottom-0 right-1/4;
    background: radial-gradient(circle, rgba(45, 212, 191, 0.12), transparent 70%);
  }

  .cta-grid {
    @apply grid md:grid-cols-2 gap-6 lg:gap-8;
  }

  .cta-card {
    @apply relative p-8 md:p-10 rounded-2xl overflow-hidden;
  }

  .cta-card-join {
    @apply border border-accent/30;
    background: linear-gradient(135deg, rgba(56, 189, 248, 0.1) 0%, rgba(56, 189, 248, 0.02) 100%);
  }

  .cta-card-join::before {
    content: '';
    @apply absolute inset-0 opacity-30;
    background: radial-gradient(circle at top right, rgba(56, 189, 248, 0.2), transparent 50%);
  }

  .cta-card-funder {
    @apply border border-accent-2/30;
    background: linear-gradient(135deg, rgba(45, 212, 191, 0.1) 0%, rgba(45, 212, 191, 0.02) 100%);
  }

  .cta-card-funder::before {
    content: '';
    @apply absolute inset-0 opacity-30;
    background: radial-gradient(circle at top right, rgba(45, 212, 191, 0.2), transparent 50%);
  }

  .cta-card-content {
    @apply relative z-10 text-center;
  }

  .cta-eyebrow {
    @apply inline-block text-xs font-bold uppercase tracking-[0.2em] text-accent mb-4;
  }

  .cta-eyebrow-alt {
    @apply text-accent-2;
  }

  .cta-title {
    @apply text-2xl md:text-3xl font-black text-white mb-4;
  }

  .cta-desc {
    @apply text-white/60 mb-6 max-w-md mx-auto;
  }

  .btn-cta-primary {
    @apply inline-flex items-center gap-2 px-6 py-3;
    @apply bg-accent text-white font-bold text-sm;
    @apply rounded-full no-underline;
    @apply transition-all duration-300;
  }

  .btn-cta-primary:hover {
    @apply bg-accent/90 gap-3;
    transform: translateY(-2px);
  }

  .btn-cta-secondary {
    @apply inline-flex items-center gap-2 px-6 py-3;
    @apply text-white font-bold text-sm;
    @apply border-2 border-accent-2/50 rounded-full no-underline;
    @apply transition-all duration-300;
  }

  .btn-cta-secondary:hover {
    @apply border-accent-2 bg-accent-2/10 gap-3;
  }

  /* ============================================
     Buttons
     ============================================ */
  .btn-primary {
    @apply inline-flex items-center gap-2 px-5 py-2.5;
    @apply bg-accent text-white font-bold text-sm;
    @apply rounded-lg no-underline;
    @apply transition-all duration-200;
  }

  .btn-primary:hover {
    @apply bg-accent/90;
    transform: translateY(-1px);
  }

  .btn-outline-light {
    @apply inline-flex items-center gap-2 px-5 py-2.5;
    @apply text-white font-bold text-sm;
    @apply border border-white/30 rounded-lg no-underline;
    @apply transition-all duration-200;
  }

  .btn-outline-light:hover {
    @apply border-white/60 bg-white/10 gap-3;
  }

  /* ============================================
     Responsive Adjustments
     ============================================ */
  @media (max-width: 768px) {
    .hero-content {
      padding-top: 7rem;
      padding-bottom: 8rem;
    }

    .hero-title {
      @apply text-4xl;
    }

    .hero-stats {
      @apply gap-4;
    }

    .stat-value {
      @apply text-xl;
    }

    .scroll-indicator {
      @apply bottom-6;
    }

    .pillars-grid {
      @apply gap-4;
    }

    .system-card {
      min-height: 360px;
    }
  }

  /* ============================================
     Reduced Motion
     ============================================ */
  @media (prefers-reduced-motion: reduce) {
    .hero-image {
      animation: none;
      transform: scale(1);
    }

    .particle {
      animation: none;
    }

    .badge-dot {
      animation: none;
    }

    .title-accent {
      animation: none;
    }

    .scroll-indicator {
      animation: none;
      opacity: 1;
    }

    .scroll-dot {
      animation: none;
    }

    .resilience-orb-1,
    .resilience-orb-2 {
      animation: none;
    }

    .system-card,
    .pillar-card,
    .organism-card,
    .news-card,
    .stat-card,
    .pi-card {
      transition: none;
    }

    .card-media img,
    .organism-visual img,
    .news-image img {
      transition: none;
    }
  }
</style>

<script>
  // Parallax effect for hero
  const initParallax = () => {
    const heroImage = document.querySelector('.hero-image') as HTMLElement;
    if (!heroImage) return;

    let ticking = false;

    const handleScroll = () => {
      if (!ticking) {
        requestAnimationFrame(() => {
          const scrolled = window.scrollY;
          const rate = scrolled * 0.3;
          heroImage.style.transform = `scale(1) translateY(${rate}px)`;
          ticking = false;
        });
        ticking = true;
      }
    };

    if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
      window.addEventListener('scroll', handleScroll, { passive: true });
    }
  };

  // Count-up animation for stats
  const initCountUp = () => {
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            const el = entry.target as HTMLElement;
            const target = parseInt(el.dataset.target || '0', 10);
            el.textContent = '0';
            animateCount(el, target);
            observer.unobserve(el);
          }
        });
      },
      { threshold: 0.5 }
    );

    document.querySelectorAll('.stat-number[data-target]').forEach((el) => {
      observer.observe(el);
    });
  };

  const animateCount = (el: HTMLElement, target: number) => {
    const duration = 1800;
    const start = performance.now();

    const update = (currentTime: number) => {
      const elapsed = currentTime - start;
      const progress = Math.min(elapsed / duration, 1);
      const eased = 1 - Math.pow(1 - progress, 4);
      const current = Math.round(eased * target);

      el.textContent = current.toString();

      if (progress < 1) {
        requestAnimationFrame(update);
      }
    };

    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
      el.textContent = target.toString();
    } else {
      requestAnimationFrame(update);
    }
  };

  // Initialize
  initParallax();
  initCountUp();

  // Re-init after view transitions
  document.addEventListener('astro:after-swap', () => {
    initParallax();
    initCountUp();
  });
</script>
