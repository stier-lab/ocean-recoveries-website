---
import Layout from '@layouts/Layout.astro';
import WaveDivider from '@components/shared/WaveDivider.astro';
import StudySitesMap from '@components/research/StudySitesMap';
import { posts } from '@data/posts';

// Get 3 most recent news posts for carousel
const recentPosts = [...posts]
  .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime())
  .slice(0, 3);

// Format date helper
const formatDate = (dateStr: string) => {
  return new Date(dateStr).toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'short',
    day: 'numeric',
  });
};
---

<Layout
  title="Ocean Recoveries Lab | Engineering Resilience from Organisms to Ecosystems"
  description="Research lab at UC Santa Barbara studying coral reef and kelp forest resilience. We trace the mechanisms of resistance, recovery, and reorganization to make restoration predictable."
  keywords={['Ocean Recoveries Lab', 'coral reef research', 'kelp forest ecology', 'marine conservation', 'UC Santa Barbara', 'Adrian Stier', 'ecosystem resilience', 'marine biology research', 'resistance', 'recovery', 'reorganization']}
>
  <!-- Hero Section -->
  <section class="hero-section relative min-h-[100svh] flex items-center overflow-visible">
    <!-- Background Image with Parallax -->
    <div
      class="absolute inset-0 bg-cover bg-center bg-no-repeat parallax-bg"
      style="background-image: url('/images/coral-reef-panorama-anthias-fish.jpeg');"
    >
      <!-- Strong left-to-right gradient for text legibility -->
      <div class="hero-overlay"></div>
    </div>

    <!-- Hero Content - Left aligned -->
    <div class="relative z-10 container px-4 pt-28 pb-32 md:pt-32 md:pb-40">
      <div class="hero-content max-w-2xl">
        <!-- Preheader -->
        <p class="hero-preheader">
          UC Santa Barbara
        </p>

        <!-- Single, confident H1 -->
        <h1 class="hero-title">
          Ocean Recoveries Lab
        </h1>

        <!-- Sharp subhead -->
        <p class="hero-subhead">
          Understanding collapse. Designing recovery.
        </p>

        <!-- One proof-oriented line -->
        <p class="hero-description">
          We study coral reefs and kelp forests to identify the mechanisms that control resistance and recovery.
        </p>

        <!-- Credibility strip -->
        <div class="hero-credibility">
          <span>Coral regeneration</span>
          <span class="hero-credibility-dot"></span>
          <span>Kelp tipping points</span>
          <span class="hero-credibility-dot"></span>
          <span>Restoration strategy</span>
        </div>

        <!-- CTAs - One primary, one text secondary -->
        <div class="hero-cta-row">
          <a href="/join" class="hero-btn-primary">
            Join the Lab
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
            </svg>
          </a>
          <a href="/for-funders" class="hero-btn-secondary">
            For Funders
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
            </svg>
          </a>
        </div>
      </div>

      <!-- Scroll Prompt - More visible -->
      <a href="#study-systems" class="hero-scroll-cue">
        <span>Scroll</span>
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7" />
        </svg>
      </a>
    </div>

    <!-- Wave at bottom of hero -->
    <WaveDivider id="hero-wave" fillColor="surface" />
  </section>

  <!-- Two Systems, Two Failure Modes -->
  <section id="study-systems" class="section-lg bg-surface relative scroll-mt-20">
    <div class="container">
      <div class="text-center mb-12 scroll-reveal">
        <h2 class="mb-6">Two Systems, Two Failure Modes</h2>
        <p class="text-lg md:text-xl text-muted leading-relaxed max-w-3xl mx-auto">
          We work in kelp forests and coral reefs because they fail in fundamentally different ways. Comparing how they break reveals which mechanisms generalize—and which interventions transfer.
        </p>
      </div>

      <!-- Interactive Map -->
      <div class="max-w-5xl mx-auto scroll-reveal mb-12">
        <StudySitesMap client:load />
      </div>

      <!-- Study System Cards -->
      <div class="grid md:grid-cols-2 gap-8 max-w-5xl mx-auto">
        <!-- Coral Reefs Card -->
        <a href="/research/coral-reefs" class="study-card scroll-reveal stagger-1 group">
          <div class="study-card-image">
            <img src="/images/cauliflower-coral-damselfish-reef.jpeg" alt="Coral reef in Mo'orea" loading="lazy" />
            <div class="study-card-overlay"></div>
          </div>
          <div class="study-card-content">
            <div class="study-location">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
              </svg>
              <span>Mo'orea, French Polynesia</span>
            </div>
            <h3 class="study-title">Coral Reefs</h3>
            <p class="study-description">Coral reefs reveal slow, chronic failure. When corals are damaged, their fate depends on wound healing and regeneration at the colony level. We study how these individual capacities aggregate into population recovery—and why reefs stall, rebound, or reorganize.</p>
            <div class="study-link">
              <span>Explore research</span>
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
              </svg>
            </div>
          </div>
        </a>

        <!-- Kelp Forests Card -->
        <a href="/research/kelp-forests" class="study-card scroll-reveal stagger-2 group">
          <div class="study-card-image">
            <img src="/images/giant-kelp-sunlight-underwater.jpeg" alt="Kelp forest in Santa Barbara" loading="lazy" />
            <div class="study-card-overlay"></div>
          </div>
          <div class="study-card-content">
            <div class="study-location">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
              </svg>
              <span>Santa Barbara, California</span>
            </div>
            <h3 class="study-title">Kelp Forests</h3>
            <p class="study-description">Kelp forests expose fast, nonlinear transitions. Consumer–predator feedbacks can flip forests to barrens in months, and hysteresis can lock them there. We study what governs the tipping point—and what breaks the lock.</p>
            <div class="study-link">
              <span>Explore research</span>
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
              </svg>
            </div>
          </div>
        </a>
      </div>
    </div>

    <WaveDivider id="study-wave" fillColor="navy-deep" />
  </section>

  <!-- Resilience Across Scales -->
  <section class="section-lg bg-navy-deep relative overflow-visible">
    <!-- Animated Blob Shapes -->
    <div class="blob-container" aria-hidden="true">
      <div class="blob blob-1"></div>
      <div class="blob blob-2"></div>
    </div>
    <div class="container relative z-10">
      <!-- Section intro -->
      <div class="text-center mb-12 scroll-reveal">
        <h2 class="text-white mb-6">Resilience Across Scales</h2>
        <p class="lead max-w-3xl mx-auto text-white/60">
          Resilience isn't something ecosystems "have." It emerges from processes at multiple levels—and these levels connect. Individual capacity shapes population recovery. Population dynamics alter species interactions. Ecosystem context constrains what individuals can tolerate.
        </p>
      </div>

      <!-- Three Pillars -->
      <div class="pillars-grid">
        <!-- Resistance -->
        <div class="pillar-card relative scroll-reveal stagger-1">
          <div class="pillar-icon pillar-icon-1">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
            </svg>
          </div>
          <h3 class="pillar-title">Resistance</h3>
          <p class="pillar-desc">What prevents collapse when disturbance hits.</p>
          <ul class="pillar-topics">
            <li>
              <span class="text-accent font-semibold">Individual:</span>
              <span>stress tolerance, damage thresholds, physiological buffering</span>
            </li>
            <li>
              <span class="text-accent font-semibold">Population:</span>
              <span>demographic buffering, spatial refugia</span>
            </li>
            <li>
              <span class="text-accent font-semibold">Ecosystem:</span>
              <span>stabilizing feedbacks, trophic structure, interaction strengths</span>
            </li>
          </ul>
        </div>

        <!-- Recovery -->
        <div class="pillar-card relative scroll-reveal stagger-2">
          <div class="pillar-icon pillar-icon-2">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
            </svg>
          </div>
          <h3 class="pillar-title">Recovery</h3>
          <p class="pillar-desc">What controls the speed and reliability of return.</p>
          <ul class="pillar-topics">
            <li>
              <span class="text-accent-2 font-semibold">Individual:</span>
              <span>wound healing, regeneration, regrowth capacity</span>
            </li>
            <li>
              <span class="text-accent-2 font-semibold">Population:</span>
              <span>recruitment, connectivity, density-dependent compensation</span>
            </li>
            <li>
              <span class="text-accent-2 font-semibold">Ecosystem:</span>
              <span>facilitation cascades, succession, disturbance legacies</span>
            </li>
          </ul>
        </div>

        <!-- Reorganization -->
        <div class="pillar-card relative scroll-reveal stagger-3">
          <div class="pillar-icon pillar-icon-3">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" />
            </svg>
          </div>
          <h3 class="pillar-title">Reorganization</h3>
          <p class="pillar-desc">What determines the next state when return isn't possible.</p>
          <ul class="pillar-topics">
            <li>
              <span class="text-accent-warm font-semibold">Individual:</span>
              <span>how tolerances filter survivors</span>
            </li>
            <li>
              <span class="text-accent-warm font-semibold">Population:</span>
              <span>how populations reassemble under new conditions</span>
            </li>
            <li>
              <span class="text-accent-warm font-semibold">Ecosystem:</span>
              <span>how interactions rewire into novel communities</span>
            </li>
          </ul>
        </div>
      </div>

      <!-- Section CTA -->
      <div class="text-center mt-12 scroll-reveal">
        <a href="/research" class="btn btn-secondary group">
          <span>Learn how we do science</span>
          <svg class="w-4 h-4 transition-transform group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
          </svg>
        </a>
      </div>
    </div>

    <!-- Wave -->
    <WaveDivider id="pillars-wave" fillColor="surface" />
  </section>

  <!-- What We Study - Focal Organisms -->
  <section class="section-lg bg-surface relative overflow-visible">
    <div class="container">
      <div class="text-center mb-12 scroll-reveal">
        <span class="eyebrow">What We Study</span>
        <h2 class="mb-6">Focal organisms and scales</h2>
        <p class="lead max-w-3xl mx-auto text-muted">
          Our research spans multiple organisms and scales—from the cellular mechanisms of coral healing to the ecosystem consequences of predator loss.
        </p>
      </div>

      <!-- Four-column grid -->
      <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-6 max-w-6xl mx-auto">
        <!-- Corals -->
        <div class="organism-card scroll-reveal stagger-1">
          <div class="organism-icon">
            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4.26 10.147a60.436 60.436 0 00-.491 6.347A48.627 48.627 0 0112 20.904a48.627 48.627 0 018.232-4.41 60.46 60.46 0 00-.491-6.347m-15.482 0a50.57 50.57 0 00-2.658-.813A59.905 59.905 0 0112 3.493a59.902 59.902 0 0110.399 5.84c-.896.248-1.783.52-2.658.814m-15.482 0A50.697 50.697 0 0112 13.489a50.702 50.702 0 017.74-3.342" />
            </svg>
          </div>
          <h3 class="organism-title">Corals</h3>
          <p class="organism-desc">How individual colonies heal damage, regenerate tissue, and allocate energy under thermal stress. These capacities set the ceiling for population and reef recovery.</p>
        </div>

        <!-- Lobsters & Urchins -->
        <div class="organism-card scroll-reveal stagger-2">
          <div class="organism-icon">
            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" />
            </svg>
          </div>
          <h3 class="organism-title">Lobsters & Urchins</h3>
          <p class="organism-desc">How consumers structure kelp forest dynamics through predation, grazing, and behavior. Individual foraging decisions scale up to ecosystem state shifts.</p>
        </div>

        <!-- Kelp -->
        <div class="organism-card scroll-reveal stagger-3">
          <div class="organism-icon">
            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 21a9.004 9.004 0 008.716-6.747M12 21a9.004 9.004 0 01-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 017.843 4.582M12 3a8.997 8.997 0 00-7.843 4.582m15.686 0A11.953 11.953 0 0112 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0121 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0112 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 013 12c0-1.605.42-3.113 1.157-4.418" />
            </svg>
          </div>
          <h3 class="organism-title">Kelp</h3>
          <p class="organism-desc">How individual resistance to grazing and storm damage interacts with population recruitment to determine forest persistence.</p>
        </div>

        <!-- Reef Fish -->
        <div class="organism-card scroll-reveal stagger-4">
          <div class="organism-icon">
            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M2.25 15a4.5 4.5 0 004.5 4.5H18a3.75 3.75 0 001.332-7.257 3 3 0 00-3.758-3.848 5.25 5.25 0 00-10.233 2.33A4.502 4.502 0 002.25 15z" />
            </svg>
          </div>
          <h3 class="organism-title">Reef Fish</h3>
          <p class="organism-desc">How fish–coral mutualisms enhance coral survival, and how fishing alters the interaction networks that stabilize reefs.</p>
        </div>
      </div>
    </div>

    <WaveDivider id="organisms-wave" fillColor="navy-deep" />
  </section>

  <!-- Recent News Section -->
  <section class="section-lg bg-navy-deep relative overflow-visible">
    <div class="container">
      <div class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-4 mb-10 scroll-reveal">
        <div>
          <span class="eyebrow text-accent-2">Latest Updates</span>
          <h2 class="text-white mb-0">Recent Research</h2>
        </div>
        <a href="/news" class="btn btn-secondary hidden sm:inline-flex group">
          <span>View all news</span>
          <svg class="w-4 h-4 transition-transform group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
          </svg>
        </a>
      </div>

      <!-- News Grid -->
      <div class="news-grid">
        {recentPosts.map((post, i) => (
          <article class={`news-card scroll-reveal stagger-${i + 1}`}>
            <a href={`/news/${post.slug}`} class="news-card-link group">
              <div class="news-card-image">
                <img
                  src={post.featuredImage}
                  alt={post.title}
                  loading={i === 0 ? 'eager' : 'lazy'}
                />
                <div class="news-card-date">
                  {formatDate(post.date)}
                </div>
              </div>
              <div class="news-card-body">
                <div class="news-card-tags">
                  {post.tags.slice(0, 2).map(tag => (
                    <span class="news-tag">{tag}</span>
                  ))}
                </div>
                <h3 class="news-card-title">{post.title}</h3>
                <p class="news-card-excerpt">{post.excerpt}</p>
                <div class="news-card-cta">
                  <span>Read article</span>
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
                  </svg>
                </div>
              </div>
            </a>
          </article>
        ))}
      </div>

      <div class="text-center mt-10 sm:hidden scroll-reveal">
        <a href="/news" class="btn btn-secondary">
          View All News
        </a>
      </div>
    </div>

    <!-- Wave -->
    <WaveDivider id="news-wave" fillColor="surface" />
  </section>

  <!-- About / Impact Section -->
  <section class="section-lg bg-surface relative overflow-visible">
    <div class="container relative z-10">
      <div class="grid lg:grid-cols-2 gap-12 lg:gap-20 items-center">
        <div class="scroll-reveal">
          <span class="eyebrow">Our Lab</span>
          <h2 class="mb-6">Based at UC Santa Barbara</h2>
          <p class="text-muted text-lg leading-relaxed mb-5">
            The Ocean Recoveries Lab is part of the Department of Ecology, Evolution & Marine Biology.
            We benefit from UCSB's world-class marine facilities, the Santa Barbara Coastal Long-Term Ecological Research site, and partnerships with the Moorea Coral Reef LTER.
          </p>
          <p class="text-muted leading-relaxed mb-6">
            Our team includes postdocs, graduate students, undergraduates, and collaborators translating resilience science into management and restoration strategies.
          </p>

          <!-- Lab Director -->
          <a href="/people" class="pi-card-light group">
            <img src="/images/adrian.png" alt="Adrian Stier" class="pi-photo-light" />
            <div class="pi-info-light">
              <span class="pi-name-light">Adrian Stier</span>
              <span class="pi-title-light">Associate Professor, EEMB</span>
              <span class="pi-bio-light">Runs long-term experiments at MCR and SBC LTER sites. 75+ papers on reef and kelp dynamics.</span>
            </div>
            <svg class="pi-arrow-light" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
            </svg>
          </a>

          <a href="/people" class="btn btn-primary group mt-6">
            <span>Meet the Team</span>
            <svg class="w-4 h-4 transition-transform group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
            </svg>
          </a>
        </div>

        <div class="stats-grid-light">
          <div class="stat-card-light scroll-reveal stagger-1">
            <span class="stat-number-light" data-target="75">75</span>
            <span class="stat-suffix-light">+</span>
            <span class="stat-label-light">Publications</span>
          </div>
          <div class="stat-card-light scroll-reveal stagger-2">
            <span class="stat-number-light" data-target="15">15</span>
            <span class="stat-suffix-light">yrs</span>
            <span class="stat-label-light">Research Experience</span>
          </div>
          <div class="stat-card-light scroll-reveal stagger-3">
            <span class="stat-number-light" data-target="2">2</span>
            <span class="stat-label-light">LTER Sites</span>
          </div>
          <div class="stat-card-light scroll-reveal stagger-4">
            <span class="stat-number-light" data-target="12">12</span>
            <span class="stat-suffix-light">+</span>
            <span class="stat-label-light">Partner Institutions</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Wave -->
    <WaveDivider id="about-wave" fillColor="navy-deep" />
  </section>

  <!-- CTA Section -->
  <section class="section-lg bg-navy-deep">
    <div class="container">
      <!-- CTA Cards -->
      <div class="grid md:grid-cols-2 gap-6 lg:gap-8">
        <!-- For Prospective Students/Postdocs -->
        <div class="join-cta scroll-reveal">
          <div class="join-cta-content">
            <span class="eyebrow text-accent">For Researchers</span>
            <h2 class="text-2xl md:text-3xl mb-4">Join Our Team</h2>
            <p class="text-white/60 max-w-md mx-auto mb-6">
              We're seeking researchers at all career stages who want to understand and restore ocean ecosystems—from molecular mechanisms to ecosystem dynamics.
            </p>
            <a href="/join" class="btn btn-primary group">
              <span>View Opportunities</span>
              <svg class="w-4 h-4 transition-transform group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
              </svg>
            </a>
          </div>
        </div>

        <!-- For Funders/Partners -->
        <div class="join-cta funder-cta scroll-reveal stagger-1">
          <div class="join-cta-content">
            <span class="eyebrow text-accent-2">For Funders</span>
            <h2 class="text-2xl md:text-3xl mb-4">Partner With Us</h2>
            <p class="text-white/60 max-w-md mx-auto mb-6">
              Support research that identifies why ecosystems fail and what makes restoration succeed.
            </p>
            <a href="/for-funders" class="btn btn-secondary group">
              <span>Learn More</span>
              <svg class="w-4 h-4 transition-transform group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
              </svg>
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>
</Layout>

<style>
  /* ========================================
     Hero Section - Clean, Nike-inspired
     ======================================== */

  /* Strong overlay for text legibility */
  .hero-overlay {
    @apply absolute inset-0;
    background: linear-gradient(
      to right,
      rgba(11, 37, 69, 0.95) 0%,
      rgba(11, 37, 69, 0.85) 35%,
      rgba(11, 37, 69, 0.6) 55%,
      rgba(11, 37, 69, 0.3) 75%,
      rgba(11, 37, 69, 0.2) 100%
    );
  }

  @media (max-width: 768px) {
    .hero-overlay {
      background: linear-gradient(
        to bottom,
        rgba(11, 37, 69, 0.7) 0%,
        rgba(11, 37, 69, 0.85) 50%,
        rgba(11, 37, 69, 0.95) 100%
      );
    }
  }

  /* Hero content animations */
  .hero-content {
    opacity: 0;
    animation: heroFadeIn 0.8s ease-out 0.1s forwards;
  }

  @keyframes heroFadeIn {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Preheader */
  .hero-preheader {
    @apply text-xs font-bold uppercase tracking-widest text-accent-2 mb-4;
  }

  /* Clean H1 - no gradients, no glow */
  .hero-title {
    @apply text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-black text-white mb-6;
    @apply tracking-tight leading-none;
  }

  /* Sharp subhead */
  .hero-subhead {
    @apply text-xl md:text-2xl font-semibold text-white/90 mb-4;
    @apply tracking-tight;
  }

  /* Description with good contrast */
  .hero-description {
    @apply text-base md:text-lg text-white/70 mb-6 leading-relaxed;
    @apply max-w-lg;
  }

  /* Credibility strip */
  .hero-credibility {
    @apply flex flex-wrap items-center gap-2 text-xs md:text-sm font-medium text-white/50 mb-8;
  }

  .hero-credibility-dot {
    @apply w-1 h-1 rounded-full bg-accent/60;
  }

  /* CTA row */
  .hero-cta-row {
    @apply flex flex-wrap items-center gap-4;
  }

  /* Primary button - flat, crisp, minimal */
  .hero-btn-primary {
    @apply inline-flex items-center gap-2 px-5 py-2.5;
    @apply bg-white text-navy-deep font-semibold text-sm;
    @apply rounded-md no-underline;
    @apply transition-all duration-200;
  }

  .hero-btn-primary:hover {
    @apply bg-white/90;
    transform: translateY(-1px);
  }

  .hero-btn-primary:focus-visible {
    @apply outline-none ring-2 ring-white ring-offset-2 ring-offset-navy-deep;
  }

  /* Secondary button - text/ghost style */
  .hero-btn-secondary {
    @apply inline-flex items-center gap-2 px-4 py-2.5;
    @apply text-white/80 font-semibold text-sm;
    @apply border border-white/30 rounded-md no-underline;
    @apply transition-all duration-200;
  }

  .hero-btn-secondary:hover {
    @apply text-white border-white/50 bg-white/10;
  }

  .hero-btn-secondary:focus-visible {
    @apply outline-none ring-2 ring-white/50 ring-offset-2 ring-offset-navy-deep;
  }

  /* Scroll cue - visible and clear */
  .hero-scroll-cue {
    @apply absolute bottom-8 left-1/2 -translate-x-1/2;
    @apply inline-flex items-center gap-2 px-4 py-2;
    @apply text-white/70 text-sm font-medium no-underline;
    @apply border border-white/20 rounded-full;
    @apply transition-all duration-300;
    @apply opacity-0;
    animation: scrollCueIn 0.6s ease-out 1s forwards;
  }

  .hero-scroll-cue:hover {
    @apply text-white border-white/40 bg-white/10;
  }

  .hero-scroll-cue svg {
    animation: scrollBounce 2s ease-in-out infinite;
  }

  @keyframes scrollCueIn {
    from {
      opacity: 0;
      transform: translateX(-50%) translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }
  }

  @keyframes scrollBounce {
    0%, 100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(4px);
    }
  }

  /* Parallax */
  .parallax-bg {
    transform: translateZ(0);
    will-change: transform;
  }

  /* ========================================
     Animated Blob Shapes (for other sections)
     ======================================== */
  .blob-container {
    @apply absolute inset-0 overflow-hidden pointer-events-none;
    z-index: 0;
  }

  .blob {
    @apply absolute rounded-full;
    filter: blur(80px);
    animation: blob-morph 20s ease-in-out infinite;
  }

  .blob-1 {
    width: 500px;
    height: 500px;
    background: radial-gradient(circle, rgba(56, 189, 248, 0.12) 0%, transparent 70%);
    top: -100px;
    right: -100px;
  }

  .blob-2 {
    width: 400px;
    height: 400px;
    background: radial-gradient(circle, rgba(45, 212, 191, 0.1) 0%, transparent 70%);
    bottom: -50px;
    left: -100px;
    animation-delay: -10s;
  }

  @keyframes blob-morph {
    0%, 100% {
      transform: translate(0, 0) scale(1) rotate(0deg);
      border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%;
    }
    25% {
      transform: translate(30px, -50px) scale(1.1) rotate(90deg);
      border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;
    }
    50% {
      transform: translate(-20px, 20px) scale(0.95) rotate(180deg);
      border-radius: 30% 60% 70% 40% / 50% 60% 30% 60%;
    }
    75% {
      transform: translate(20px, 40px) scale(1.05) rotate(270deg);
      border-radius: 50% 40% 50% 60% / 40% 60% 50% 40%;
    }
  }

  /* ========================================
     Section spacing
     ======================================== */
  .section-lg {
    @apply py-20 md:py-28 pb-28 md:pb-36;
  }

  /* ========================================
     Ecosystem Cards (Study Systems)
     ======================================== */
  .ecosystem-card {
    @apply relative rounded-2xl overflow-hidden no-underline block;
    @apply border border-line/50;
    @apply transition-all duration-500 ease-out;
    aspect-ratio: 4 / 3;
    transform-style: preserve-3d;
  }

  .ecosystem-card:hover {
    @apply -translate-y-2;
    border-color: rgba(56, 189, 248, 0.4);
    box-shadow:
      0 25px 50px -12px rgba(0, 0, 0, 0.4),
      0 0 40px rgba(56, 189, 248, 0.15);
  }

  .ecosystem-card-image {
    @apply absolute inset-0;
  }

  .ecosystem-card-image img {
    @apply w-full h-full object-cover;
    @apply transition-all duration-700 ease-out;
    transform: scale(1.05);
  }

  .ecosystem-card:hover .ecosystem-card-image img {
    transform: scale(1.12);
  }

  .ecosystem-card-overlay {
    @apply absolute inset-0;
    background: linear-gradient(
      to top,
      rgba(11, 37, 69, 0.95) 0%,
      rgba(11, 37, 69, 0.7) 35%,
      rgba(11, 37, 69, 0.3) 60%,
      transparent 100%
    );
  }

  .ecosystem-card-content {
    @apply absolute bottom-0 left-0 right-0 p-6 md:p-7;
  }

  .ecosystem-location {
    @apply inline-flex items-center gap-1.5 text-accent-2 text-xs font-bold uppercase tracking-wider mb-3;
  }

  .ecosystem-title {
    @apply text-2xl md:text-3xl font-black text-white mb-3;
    @apply transition-colors duration-300;
  }

  .ecosystem-card:hover .ecosystem-title {
    @apply text-accent;
  }

  .ecosystem-tagline {
    @apply text-white/70 text-sm leading-relaxed mb-4 line-clamp-2;
  }

  .ecosystem-link {
    @apply inline-flex items-center gap-2 text-accent text-sm font-bold;
    @apply transition-all duration-300;
  }

  .ecosystem-card:hover .ecosystem-link {
    @apply gap-3;
  }

  /* ========================================
     Compact Ecosystem Cards (below map)
     ======================================== */
  .ecosystem-card-compact {
    @apply flex rounded-xl overflow-hidden no-underline;
    @apply bg-surface-card border border-line/50;
    @apply transition-all duration-300 ease-out;
  }

  .ecosystem-card-compact:hover {
    @apply -translate-y-1;
    border-color: rgba(56, 189, 248, 0.4);
    box-shadow: 0 12px 24px -8px rgba(0, 0, 0, 0.3);
  }

  .ecosystem-card-compact-image {
    @apply w-24 md:w-32 flex-shrink-0;
  }

  .ecosystem-card-compact-image img {
    @apply w-full h-full object-cover;
    @apply transition-transform duration-500;
  }

  .ecosystem-card-compact:hover .ecosystem-card-compact-image img {
    @apply scale-110;
  }

  .ecosystem-card-compact-content {
    @apply flex-1 p-4 md:p-5 flex flex-col justify-center;
  }

  .ecosystem-location-compact {
    @apply inline-flex items-center gap-1 text-accent-2 text-xs font-bold uppercase tracking-wider mb-1.5;
  }

  .ecosystem-title-compact {
    @apply text-base md:text-lg font-bold text-ink mb-1;
    @apply transition-colors duration-200;
  }

  .ecosystem-card-compact:hover .ecosystem-title-compact {
    @apply text-accent;
  }

  .ecosystem-tagline-compact {
    @apply text-muted text-xs md:text-sm leading-relaxed mb-2 line-clamp-2;
  }

  .ecosystem-link-compact {
    @apply inline-flex items-center gap-1.5 text-accent text-xs font-bold;
    @apply transition-all duration-200;
  }

  .ecosystem-card-compact:hover .ecosystem-link-compact {
    @apply gap-2;
  }

  /* ========================================
     Research Pillars
     ======================================== */
  .pillars-grid {
    @apply grid md:grid-cols-3 gap-6 lg:gap-8 max-w-6xl mx-auto;
  }

  .pillar-card {
    @apply p-7 rounded-2xl text-left;
    @apply border border-white/10;
    @apply transition-all duration-300 ease-out;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, rgba(255, 255, 255, 0.02) 100%);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }

  .pillar-card::before {
    content: '';
    @apply absolute inset-0 rounded-2xl opacity-0;
    background: linear-gradient(135deg, rgba(56, 189, 248, 0.08) 0%, rgba(45, 212, 191, 0.04) 100%);
    transition: opacity 0.3s ease;
    z-index: -1;
  }

  .pillar-card:hover {
    @apply -translate-y-2;
    border-color: rgba(56, 189, 248, 0.4);
    box-shadow:
      0 20px 40px -12px rgba(0, 0, 0, 0.3),
      0 0 30px rgba(56, 189, 248, 0.1),
      inset 0 1px 0 rgba(255, 255, 255, 0.1);
  }

  .pillar-card:hover::before {
    opacity: 1;
  }

  .pillar-icon {
    @apply w-12 h-12 mb-5 rounded-xl;
    @apply flex items-center justify-center;
    @apply transition-all duration-500;
    position: relative;
  }

  .pillar-card:hover .pillar-icon {
    @apply scale-110;
    animation: icon-bounce 0.6s ease;
  }

  .pillar-card:hover .pillar-icon svg {
    animation: icon-wiggle 0.6s ease;
  }

  @keyframes icon-bounce {
    0%, 100% { transform: scale(1.1) translateY(0); }
    50% { transform: scale(1.15) translateY(-3px); }
  }

  @keyframes icon-wiggle {
    0% { transform: rotate(0deg); }
    25% { transform: rotate(-8deg); }
    75% { transform: rotate(8deg); }
    100% { transform: rotate(0deg); }
  }

  .pillar-icon-1 {
    @apply bg-accent/20 text-accent;
  }

  .pillar-icon-2 {
    @apply bg-accent-2/20 text-accent-2;
  }

  .pillar-icon-3 {
    @apply bg-accent-warm/20 text-accent-warm;
  }

  .pillar-title {
    @apply text-white text-lg font-bold mb-3;
  }

  .pillar-desc {
    @apply text-white/50 text-sm leading-relaxed mb-5;
  }

  .pillar-topics {
    @apply space-y-2;
  }

  .pillar-topics li {
    @apply flex items-start gap-2 text-white/70 text-sm;
  }

  /* ========================================
     News Cards
     ======================================== */
  .news-grid {
    @apply grid md:grid-cols-3 gap-6 lg:gap-8;
  }

  .news-card {
    @apply rounded-2xl overflow-hidden bg-surface-card;
    @apply border border-line/50;
    @apply transition-all duration-300 ease-out;
  }

  .news-card:hover {
    @apply -translate-y-2 shadow-xl;
    border-color: rgba(56, 189, 248, 0.3);
  }

  .news-card-link {
    @apply block no-underline h-full flex flex-col;
  }

  .news-card-image {
    @apply relative aspect-[16/10] overflow-hidden;
  }

  .news-card-image img {
    @apply w-full h-full object-cover;
    @apply transition-transform duration-500 ease-out;
  }

  .news-card:hover .news-card-image img {
    @apply scale-105;
  }

  .news-card-date {
    @apply absolute top-3 right-3;
    @apply px-3 py-1.5 rounded-full;
    @apply bg-navy-deep/80 backdrop-blur-sm;
    @apply text-white/80 text-xs font-medium;
  }

  .news-card-body {
    @apply p-5 md:p-6 flex flex-col flex-1;
  }

  .news-card-tags {
    @apply flex flex-wrap gap-2 mb-3;
  }

  .news-tag {
    @apply text-xs font-bold uppercase tracking-wide;
    @apply text-accent;
  }

  .news-card-title {
    @apply text-lg font-bold text-ink mb-3 leading-snug;
    @apply transition-colors duration-200;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .news-card:hover .news-card-title {
    @apply text-accent;
  }

  .news-card-excerpt {
    @apply text-muted text-sm leading-relaxed mb-4 flex-1;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .news-card-cta {
    @apply inline-flex items-center gap-2 text-accent text-sm font-bold;
    @apply transition-all duration-300 mt-auto;
  }

  .news-card:hover .news-card-cta {
    @apply gap-3;
  }

  /* ========================================
     PI Card - Compact Lab Director
     ======================================== */
  .pi-card {
    display: flex;
    align-items: center;
    gap: 0.875rem;
    padding: 0.75rem 1rem;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 0.75rem;
    text-decoration: none;
    transition: all 0.2s ease;
    margin-bottom: 0;
  }

  .pi-card:hover {
    background: rgba(255, 255, 255, 0.06);
    border-color: rgba(56, 189, 248, 0.3);
  }

  .pi-photo {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid rgba(56, 189, 248, 0.3);
    flex-shrink: 0;
  }

  .pi-info {
    display: flex;
    flex-direction: column;
    gap: 0.125rem;
    flex: 1;
    min-width: 0;
  }

  .pi-name {
    font-size: 0.875rem;
    font-weight: 700;
    color: #f1f5f9;
  }

  .pi-title {
    font-size: 0.6875rem;
    font-weight: 600;
    color: #38bdf8;
    text-transform: uppercase;
    letter-spacing: 0.03em;
  }

  .pi-bio {
    font-size: 0.75rem;
    color: rgba(241, 245, 249, 0.5);
    line-height: 1.4;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .pi-arrow {
    width: 1rem;
    height: 1rem;
    color: rgba(56, 189, 248, 0.4);
    flex-shrink: 0;
    transition: all 0.2s ease;
  }

  .pi-card:hover .pi-arrow {
    color: #38bdf8;
    transform: translateX(3px);
  }

  /* ========================================
     Stats Section
     ======================================== */
  .stats-grid {
    @apply grid grid-cols-2 gap-4 lg:gap-5;
  }

  .stat-card {
    @apply relative bg-white/[0.03] border border-white/10 rounded-2xl;
    @apply p-6 lg:p-7 text-center;
    @apply transition-all duration-300 ease-out;
  }

  .stat-card:hover {
    @apply bg-white/[0.06] -translate-y-1;
    border-color: rgba(56, 189, 248, 0.3);
  }

  .stat-number {
    @apply text-4xl lg:text-5xl font-black text-accent;
    @apply inline;
  }

  .stat-suffix {
    @apply text-xl lg:text-2xl font-bold text-accent/70 ml-0.5;
  }

  .stat-label {
    @apply block text-xs font-semibold text-white/50 uppercase tracking-wider mt-2;
  }

  /* ========================================
     Join CTA
     ======================================== */
  .join-cta {
    @apply relative rounded-2xl overflow-hidden;
    @apply bg-gradient-to-br from-accent/10 via-accent/5 to-accent-2/10;
    @apply border border-accent/20;
    @apply p-8 md:p-10;
  }

  .join-cta::before {
    content: '';
    @apply absolute inset-0 opacity-30;
    background: radial-gradient(circle at top right, rgba(56, 189, 248, 0.15), transparent 50%),
                radial-gradient(circle at bottom left, rgba(45, 212, 191, 0.15), transparent 50%);
  }

  .join-cta-content {
    @apply relative z-10 text-center;
  }

  .funder-cta {
    @apply bg-gradient-to-br from-accent-2/10 via-accent-2/5 to-accent/10;
    @apply border-accent-2/20;
  }

  .funder-cta::before {
    background: radial-gradient(circle at top right, rgba(45, 212, 191, 0.15), transparent 50%),
                radial-gradient(circle at bottom left, rgba(56, 189, 248, 0.15), transparent 50%);
  }

  /* ========================================
     Experiment Cards (Two Natural Experiments)
     ======================================== */
  .experiment-card {
    @apply relative rounded-2xl overflow-hidden no-underline block;
    @apply border border-white/10;
    @apply transition-all duration-500 ease-out;
    min-height: 320px;
  }

  .experiment-card:hover {
    @apply -translate-y-2;
    border-color: rgba(56, 189, 248, 0.4);
    box-shadow:
      0 25px 50px -12px rgba(0, 0, 0, 0.4),
      0 0 40px rgba(56, 189, 248, 0.15);
  }

  .experiment-card-image {
    @apply absolute inset-0;
  }

  .experiment-card-image img {
    @apply w-full h-full object-cover;
    @apply transition-all duration-700 ease-out;
    transform: scale(1.05);
  }

  .experiment-card:hover .experiment-card-image img {
    transform: scale(1.12);
  }

  .experiment-card-overlay {
    @apply absolute inset-0;
    background: linear-gradient(
      to top,
      rgba(11, 37, 69, 0.98) 0%,
      rgba(11, 37, 69, 0.85) 40%,
      rgba(11, 37, 69, 0.5) 70%,
      rgba(11, 37, 69, 0.3) 100%
    );
  }

  .experiment-card-content {
    @apply absolute bottom-0 left-0 right-0 p-6 md:p-7;
  }

  .experiment-location {
    @apply inline-flex items-center gap-1.5 text-accent-2 text-xs font-bold uppercase tracking-wider mb-2;
  }

  .experiment-title {
    @apply text-2xl md:text-3xl font-black text-white mb-3;
    @apply transition-colors duration-300;
  }

  .experiment-card:hover .experiment-title {
    @apply text-accent;
  }

  .experiment-question {
    @apply text-white font-medium text-sm leading-relaxed mb-2;
  }

  .experiment-finding {
    @apply text-white/60 text-sm leading-relaxed mb-4;
  }

  .experiment-link {
    @apply inline-flex items-center gap-2 text-accent text-sm font-bold;
    @apply transition-all duration-300;
  }

  .experiment-card:hover .experiment-link {
    @apply gap-3;
  }

  /* ========================================
     Study System Cards (Two Failure Modes)
     ======================================== */
  .study-card {
    @apply relative rounded-2xl overflow-hidden no-underline block;
    @apply border border-line/50 bg-surface-card;
    @apply transition-all duration-500 ease-out;
    min-height: 380px;
  }

  .study-card:hover {
    @apply -translate-y-2;
    border-color: rgba(56, 189, 248, 0.4);
    box-shadow:
      0 25px 50px -12px rgba(0, 0, 0, 0.2),
      0 0 40px rgba(56, 189, 248, 0.1);
  }

  .study-card-image {
    @apply absolute inset-0;
  }

  .study-card-image img {
    @apply w-full h-full object-cover;
    @apply transition-all duration-700 ease-out;
    transform: scale(1.05);
  }

  .study-card:hover .study-card-image img {
    transform: scale(1.12);
  }

  .study-card-overlay {
    @apply absolute inset-0;
    background: linear-gradient(
      to top,
      rgba(15, 23, 42, 0.98) 0%,
      rgba(15, 23, 42, 0.9) 35%,
      rgba(15, 23, 42, 0.6) 60%,
      rgba(15, 23, 42, 0.3) 100%
    );
  }

  .study-card-content {
    @apply absolute bottom-0 left-0 right-0 p-6 md:p-7;
  }

  .study-location {
    @apply inline-flex items-center gap-1.5 text-accent-2 text-xs font-bold uppercase tracking-wider mb-2;
  }

  .study-title {
    @apply text-2xl md:text-3xl font-black text-white mb-3;
    @apply transition-colors duration-300;
  }

  .study-card:hover .study-title {
    @apply text-accent;
  }

  .study-description {
    @apply text-white/70 text-sm leading-relaxed mb-4;
  }

  .study-link {
    @apply inline-flex items-center gap-2 text-accent text-sm font-bold;
    @apply transition-all duration-300;
  }

  .study-card:hover .study-link {
    @apply gap-3;
  }

  /* ========================================
     Organism Cards (What We Study)
     ======================================== */
  .organism-card {
    @apply p-6 rounded-2xl text-center;
    @apply bg-surface-card border border-line/50;
    @apply transition-all duration-300 ease-out;
  }

  .organism-card:hover {
    @apply -translate-y-2;
    border-color: rgba(56, 189, 248, 0.3);
    box-shadow: 0 12px 24px -8px rgba(0, 0, 0, 0.15);
  }

  .organism-icon {
    @apply w-16 h-16 mx-auto mb-4 rounded-2xl;
    @apply flex items-center justify-center;
    @apply bg-accent/10 text-accent;
    @apply transition-all duration-300;
  }

  .organism-card:hover .organism-icon {
    @apply bg-accent/20 scale-110;
  }

  .organism-title {
    @apply text-lg font-bold text-ink mb-3;
  }

  .organism-desc {
    @apply text-muted text-sm leading-relaxed;
  }

  /* ========================================
     Research Story Section
     ======================================== */
  .research-story {
    @apply grid lg:grid-cols-2 gap-10 lg:gap-16 items-center max-w-6xl mx-auto;
  }

  .research-story-image {
    @apply rounded-2xl overflow-hidden;
    @apply border border-line/50;
  }

  .research-story-image img {
    @apply w-full h-auto;
    aspect-ratio: 4 / 3;
    object-fit: cover;
  }

  .research-story-content h2,
  .research-story-content h3 {
    @apply text-ink;
  }

  /* Reversed layout for alternating stories */
  .research-story-reverse {
    @apply grid lg:grid-cols-2 gap-10 lg:gap-16 items-center max-w-6xl mx-auto;
  }

  @media (min-width: 1024px) {
    .research-story-reverse .research-story-image {
      order: 2;
    }
    .research-story-reverse .research-story-content {
      order: 1;
    }
  }

  /* ========================================
     Light Mode Stat Cards (for bg-surface)
     ======================================== */
  .stats-grid-light {
    @apply grid grid-cols-2 gap-4 lg:gap-5;
  }

  .stat-card-light {
    @apply relative bg-surface-card border border-line/50 rounded-2xl;
    @apply p-6 lg:p-7 text-center;
    @apply transition-all duration-300 ease-out;
  }

  .stat-card-light:hover {
    @apply -translate-y-1;
    border-color: rgba(56, 189, 248, 0.3);
    box-shadow: 0 12px 24px -8px rgba(0, 0, 0, 0.15);
  }

  .stat-number-light {
    @apply text-4xl lg:text-5xl font-black text-accent;
    @apply inline;
  }

  .stat-suffix-light {
    @apply text-xl lg:text-2xl font-bold text-accent/70 ml-0.5;
  }

  .stat-label-light {
    @apply block text-xs font-semibold text-muted uppercase tracking-wider mt-2;
  }

  /* ========================================
     Light Mode PI Card (for bg-surface)
     ======================================== */
  .pi-card-light {
    display: flex;
    align-items: center;
    gap: 0.875rem;
    padding: 0.75rem 1rem;
    background: rgba(30, 41, 59, 0.05);
    border: 1px solid rgba(30, 41, 59, 0.1);
    border-radius: 0.75rem;
    text-decoration: none;
    transition: all 0.2s ease;
    margin-bottom: 0;
  }

  .pi-card-light:hover {
    background: rgba(30, 41, 59, 0.08);
    border-color: rgba(56, 189, 248, 0.3);
  }

  .pi-photo-light {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid rgba(56, 189, 248, 0.3);
    flex-shrink: 0;
  }

  .pi-info-light {
    display: flex;
    flex-direction: column;
    gap: 0.125rem;
    flex: 1;
    min-width: 0;
  }

  .pi-name-light {
    font-size: 0.875rem;
    font-weight: 700;
    color: #1e293b;
  }

  .pi-title-light {
    font-size: 0.6875rem;
    font-weight: 600;
    color: #38bdf8;
    text-transform: uppercase;
    letter-spacing: 0.03em;
  }

  .pi-bio-light {
    font-size: 0.75rem;
    color: rgba(100, 116, 139, 0.8);
    line-height: 1.4;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .pi-arrow-light {
    width: 1rem;
    height: 1rem;
    color: rgba(56, 189, 248, 0.4);
    flex-shrink: 0;
    transition: all 0.2s ease;
  }

  .pi-card-light:hover .pi-arrow-light {
    color: #38bdf8;
    transform: translateX(3px);
  }

  /* ========================================
     Reduced motion
     ======================================== */
  @media (prefers-reduced-motion: reduce) {
    .hero-content,
    .hero-scroll-cue {
      animation: none;
      opacity: 1;
    }

    .hero-scroll-cue svg {
      animation: none;
    }

    .blob {
      animation: none;
    }

    .ecosystem-card-image img,
    .news-card-image img,
    .study-card-image img {
      transition: none;
    }

    .pillar-card,
    .ecosystem-card,
    .news-card,
    .stat-card,
    .study-card {
      transition: none;
    }

    .pillar-icon,
    .pillar-icon svg {
      animation: none;
    }
  }
</style>

<script>
  // Parallax effect for hero
  const initParallax = () => {
    const parallaxBg = document.querySelector('.parallax-bg') as HTMLElement;
    if (!parallaxBg) return;

    let ticking = false;

    const handleScroll = () => {
      if (!ticking) {
        requestAnimationFrame(() => {
          const scrolled = window.scrollY;
          const rate = scrolled * 0.35;
          parallaxBg.style.transform = `translateY(${rate}px)`;
          ticking = false;
        });
        ticking = true;
      }
    };

    if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
      window.addEventListener('scroll', handleScroll, { passive: true });
    }
  };

  // Count-up animation for stats
  const initCountUp = () => {
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            const el = entry.target as HTMLElement;
            const target = parseInt(el.dataset.target || '0', 10);
            // Reset to 0 before animating
            el.textContent = '0';
            animateCount(el, target);
            observer.unobserve(el);
          }
        });
      },
      { threshold: 0.5 }
    );

    document.querySelectorAll('.stat-number[data-target], .stat-number-light[data-target]').forEach((el) => {
      observer.observe(el);
    });
  };

  const animateCount = (el: HTMLElement, target: number) => {
    const duration = 1800;
    const start = performance.now();

    const update = (currentTime: number) => {
      const elapsed = currentTime - start;
      const progress = Math.min(elapsed / duration, 1);

      // Smooth easing
      const eased = 1 - Math.pow(1 - progress, 4);
      const current = Math.round(eased * target);

      el.textContent = current.toString();

      if (progress < 1) {
        requestAnimationFrame(update);
      }
    };

    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
      el.textContent = target.toString();
    } else {
      requestAnimationFrame(update);
    }
  };

  // Initialize
  initParallax();
  initCountUp();

  // Re-init after view transitions
  document.addEventListener('astro:after-swap', () => {
    initParallax();
    initCountUp();
  });
</script>
