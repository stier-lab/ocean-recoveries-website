---
import Layout from '@layouts/Layout.astro';
import PersonCard from '@components/people/PersonCard.astro';
import BreadcrumbSchema from '@components/seo/BreadcrumbSchema.astro';
import { currentTeam, alumni } from '@data/team';

// Sort team by order
const sortedTeam = [...currentTeam].sort((a, b) => a.order - b.order);

// Alumni role colors (for visual distinction)
const alumniRoleColors: Record<string, string> = {
  'Postdoc': 'teal',
  'PhD': 'sky',
  'MS Student': 'sky',
  'Lab Manager': 'amber',
  'Undergraduate Researcher': 'warm',
};
---

<Layout
  title="People"
  description="Meet the Ocean Recoveries Lab team - researchers studying coral reef and kelp forest recovery at UC Santa Barbara."
  image="/images/research-team-group-photo-beach.jpeg"
  keywords={['research team', 'marine scientists', 'UCSB researchers', 'ocean ecologists', 'Adrian Stier lab']}
>
  <!-- SEO Structured Data -->
  <BreadcrumbSchema
    items={[
      { name: 'People', url: '/people' }
    ]}
  />

  <!-- Quick Nav -->
  <nav class="section-nav bg-surface pt-24 md:pt-28 pb-4" aria-label="Page sections">
    <div class="container">
      <div class="flex flex-wrap items-center justify-center gap-3 text-sm">
        <a href="#team" class="nav-pill">Current Team</a>
        <span class="text-line">/</span>
        <a href="#alumni" class="nav-pill">Alumni</a>
        <span class="text-line">/</span>
        <a href="#join" class="nav-pill nav-pill-cta">Join the Lab</a>
      </div>
    </div>
  </nav>

  <!-- Current Members -->
  <section id="team" class="section bg-surface pt-4 pb-16" aria-labelledby="team-heading">
    <div class="container">
      <div class="text-center mb-8 scroll-reveal">
        <h1 id="team-heading" class="text-3xl md:text-4xl font-bold">
          <span class="gradient-text">Meet the Lab</span>
        </h1>
      </div>

      <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6" role="list">
        {sortedTeam.map((member, i) => (
          <div class={`scroll-reveal stagger-${(i % 3) + 1}`}>
            <PersonCard {...member} />
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Alumni -->
  <section id="alumni" class="section bg-surface-elevated pt-16 pb-20" aria-labelledby="alumni-heading">
    <div class="container">
      <div class="flex items-center gap-4 mb-10 scroll-reveal">
        <div class="h-px flex-1 bg-gradient-to-r from-transparent via-line to-transparent" aria-hidden="true"></div>
        <h2 id="alumni-heading" class="text-2xl font-semibold text-muted whitespace-nowrap">Where Are They Now</h2>
        <div class="h-px flex-1 bg-gradient-to-r from-transparent via-line to-transparent" aria-hidden="true"></div>
      </div>

      <div class="alumni-grid">
        {alumni.map((alum, i) => {
          const roleColor = alumniRoleColors[alum.role] || 'sky';
          return (
            <div class={`alumni-card scroll-reveal stagger-${(i % 6) + 1}`}>
              {alum.image ? (
                <img src={alum.image} alt={`${alum.name} portrait`} class="alumni-photo" loading="lazy" width="44" height="44" />
              ) : (
                <div class="alumni-avatar">
                  <span class="alumni-initial">{alum.name.charAt(0)}</span>
                </div>
              )}
              <div class="alumni-info">
                <span class="alumni-name">{alum.name}</span>
                <span class="alumni-meta">
                  <span class={`role-dot role-${roleColor}`}></span>
                  {alum.role} Â· {alum.years}
                </span>
                {alum.currentPosition && (
                  <span class="alumni-current">{alum.currentPosition}</span>
                )}
              </div>
              {alum.linkedin && (
                <a
                  href={alum.linkedin}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="linkedin-link"
                  aria-label={`${alum.name}'s LinkedIn`}
                >
                  <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                  </svg>
                </a>
              )}
            </div>
          );
        })}
      </div>
    </div>
  </section>

  <!-- Join CTA -->
  <section id="join" class="cta-section relative py-20 overflow-hidden" aria-labelledby="join-heading">
    <div class="absolute inset-0 bg-gradient-to-br from-navy-deep via-surface to-navy-deep"></div>
    <div class="cta-glow" aria-hidden="true"></div>
    <div class="container relative z-10 text-center">
      <h2 id="join-heading" class="text-3xl md:text-4xl font-bold text-white mb-3 scroll-reveal">Join the Lab</h2>
      <p class="text-white/60 max-w-md mx-auto mb-8 scroll-reveal">
        We're always looking for curious minds passionate about ocean recovery.
      </p>
      <a href="/join" class="cta-btn scroll-reveal">
        <span>View Opportunities</span>
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
        </svg>
      </a>
    </div>
  </section>
</Layout>

<style>
  /* Section Nav */
  .section-nav {
    @apply sticky top-16 z-30 backdrop-blur-sm;
    background: rgba(15, 23, 42, 0.9);
  }

  .nav-pill {
    @apply px-3 py-1.5 rounded-full text-muted;
    @apply transition-all duration-200 no-underline;
    @apply hover:text-ink hover:bg-line/30;
    @apply focus:outline-none focus-visible:ring-2 focus-visible:ring-accent focus-visible:ring-offset-2 focus-visible:ring-offset-surface;
  }

  .nav-pill-cta {
    @apply text-accent font-medium;
    @apply hover:bg-accent/10;
  }

  /* Gradient Text */
  .gradient-text {
    background: linear-gradient(135deg, #f1f5f9 0%, #38bdf8 50%, #2dd4bf 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  /* Alumni Grid */
  .alumni-grid {
    @apply grid sm:grid-cols-2 lg:grid-cols-3 gap-4;
  }

  .alumni-card {
    @apply flex items-center gap-3 p-4 rounded-lg;
    @apply border border-transparent;
    @apply transition-all duration-200;
    background: rgba(30, 41, 59, 0.4);
  }

  .alumni-card:hover {
    @apply border-line;
    background: rgba(30, 41, 59, 0.7);
  }

  .alumni-card:hover .linkedin-link {
    @apply opacity-100;
  }

  .alumni-photo {
    @apply w-11 h-11 rounded-full flex-shrink-0 object-cover;
    @apply ring-2 ring-line;
  }

  .alumni-avatar {
    @apply w-11 h-11 rounded-full flex-shrink-0;
    @apply bg-accent/10;
    @apply flex items-center justify-center;
    @apply ring-2 ring-accent/20;
  }

  .alumni-initial {
    @apply text-base font-bold text-accent;
  }

  .alumni-info {
    @apply flex flex-col gap-0.5 min-w-0 flex-1;
  }

  .alumni-name {
    @apply text-sm font-semibold text-ink truncate;
  }

  .alumni-meta {
    @apply text-xs text-muted-2 flex items-center gap-1.5;
  }

  .role-dot {
    @apply w-1.5 h-1.5 rounded-full flex-shrink-0;
  }

  .role-dot.role-teal { @apply bg-accent-2; }
  .role-dot.role-sky { @apply bg-accent; }
  .role-dot.role-amber { @apply bg-amber-400; }
  .role-dot.role-warm { @apply bg-accent-warm; }

  .alumni-current {
    @apply text-xs text-muted truncate;
  }

  .linkedin-link {
    @apply p-2 rounded-md text-muted hover:text-[#0077B5] hover:bg-[#0077B5]/10;
    @apply transition-all flex-shrink-0 opacity-50;
  }

  /* CTA Section */
  .cta-glow {
    @apply absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2;
    @apply w-96 h-96 rounded-full;
    background: radial-gradient(circle, rgba(56, 189, 248, 0.15) 0%, transparent 70%);
    filter: blur(60px);
  }

  .cta-btn {
    @apply inline-flex items-center gap-2 px-6 py-3;
    @apply bg-accent text-white font-semibold rounded-full;
    @apply transition-all duration-300;
    @apply hover:bg-accent/90 hover:gap-3;
    @apply focus:outline-none focus-visible:ring-2 focus-visible:ring-accent focus-visible:ring-offset-2 focus-visible:ring-offset-surface;
  }
</style>
