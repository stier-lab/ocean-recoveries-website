
<!-- Sticky Quick actions -->
<nav class="sticky-cta" aria-label="Quick actions">
  <a href="https://www.oceanrecoveries.com/ourteam" aria-label="Join our team">Join our team</a>
  <a class="alt" href="https://www.oceanrecoveries.com/new-page" aria-label="See latest findings">Latest findings</a>
</nav>

<!-- Glossary bubble -->
<div class="glossary" aria-live="polite">
  <button class="fab" aria-expanded="false" aria-controls="glossary-panel" title="Glossary" aria-label="Open glossary">
    <svg width="26" height="26" viewBox="0 0 24 24" fill="none" aria-hidden="true">
      <path d="M5 3h11a3 3 0 0 1 3 3v13.5a.5.5 0 0 1-.8.4L17 18H6a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3Z" stroke="white" stroke-width="1.6"/>
      <path d="M5 15h12" stroke="white" stroke-width="1.6"/>
    </svg>
  </button>
  <div id="glossary-panel" class="panel" role="dialog" aria-label="Glossary">
    <h4>Glossary</h4>
    <ul class="glist">
      <li><b>Regime shift:</b> flip from coral- to algae-dominated (or vice versa).</li>
      <li><b>Material legacies:</b> post-disturbance structures (e.g., dead coral) that bias recovery.</li>
      <li><b>CAFI services:</b> cleaning, anti-predator defense, fertilization by coral associates.</li>
      <li><b>Spillover:</b> fish/larvae moving from MPAs into fished areas.</li>
      <li><b>Metapopulation:</b> network of sub-populations linked by movement.</li>
      <li><b>Bayesian model:</b> combines data plus prior knowledge.</li>
      <li><b>SEM:</b> structural equation modeling for direct/indirect effects.</li>
      <li><b>MSE:</b> management strategy evaluationâ€”test policies in a simulator first.</li>
    </ul>
  </div>
</div>

<script>
/* Smooth anchor scroll */
document.querySelectorAll('a[href^="#"]').forEach(a=>{
  a.addEventListener('click', e=>{
    const id = a.getAttribute('href');
    if(id.length > 1){
      const el = document.querySelector(id);
      if(el){
        e.preventDefault();
        el.scrollIntoView({behavior:'smooth', block:'start'});
        history.pushState(null, "", id);
      }
    }
  });
});

/* More publications toggles */
document.querySelectorAll('.more-toggle').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const tgt = document.getElementById(btn.getAttribute('aria-controls'));
    const expanded = btn.getAttribute('aria-expanded') === 'true';
    btn.setAttribute('aria-expanded', String(!expanded));
    btn.textContent = expanded ? 'View more publications' : 'Hide publications';
    tgt.hidden = expanded;
  });
});

/* Glossary dialog behaviour: focus trap + Esc close */
(()=> {
  const gloss = document.querySelector('.glossary');
  if(!gloss) return;
  const btn = gloss.querySelector('.fab');
  const panel = gloss.querySelector('.panel');
  const getFocusable = () => panel.querySelectorAll('a,button,input,select,textarea,[tabindex]:not([tabindex="-1"])');

  function openPanel(){
    gloss.classList.add('open');
    btn.setAttribute('aria-expanded','true');
    panel.setAttribute('aria-modal','true');
    (getFocusable()[0] || panel).focus();
  }
  function closePanel(){
    gloss.classList.remove('open');
    btn.setAttribute('aria-expanded','false');
    panel.removeAttribute('aria-modal');
    btn.focus();
  }

  btn.addEventListener('click', ()=>{
    gloss.classList.contains('open') ? closePanel() : openPanel();
  });

  document.addEventListener('keydown', (e)=>{
    if(!gloss.classList.contains('open')) return;
    if(e.key === 'Escape'){ e.preventDefault(); closePanel(); }
    if(e.key === 'Tab'){
      const f = [...getFocusable()];
      if(!f.length) return;
      const first = f[0], last = f[f.length-1];
      if(e.shiftKey && document.activeElement === first){ e.preventDefault(); last.focus(); }
      else if(!e.shiftKey && document.activeElement === last){ e.preventDefault(); first.focus(); }
    }
  });

  document.addEventListener('click', (e)=>{
    if(gloss.classList.contains('open') && !gloss.contains(e.target)) closePanel();
  });
})();
</script>  </div>
</div>


</body>
</html>
